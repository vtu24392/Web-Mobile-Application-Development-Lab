<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Password Change Form</title>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="bg-light d-flex justify-content-center align-items-center vh-100">

<div class="card shadow-sm p-4" style="max-width: 350px; width: 100%;">
  <h4 class="text-center mb-3">Change Password</h4>
  <form id="changePasswordForm" novalidate>
    
    <!--Username-->
    <div class="mb-3">
      <label class="form-label">Username: </label><br>
      <input id="name" name="name" type="text" placeholder="example@domain.com" class="form-control" required >
      <div class="form-text text-danger error" aria-live="polite"></div>
    </div>

    <!-- New password -->
    <div class="mb-3">
      <label class="form-label">New Password: </label><br>
      <input id="newPassword" name="newPassword" type="password" placeholder="Enter new password" class="form-control" required >
      <div class="form-text text-danger error" aria-live="polite"></div>
    </div>

    <!-- Confirm password -->
    <div class="mb-3">
      <label class="form-label">Confirm Password: </label><br>
      <input id="confirmPassword" name="confirmPassword" type="password" placeholder="Re-enter new password" class="form-control" required >
      <div class="form-text text-danger error" aria-live="polite"></div>
    </div>

    <button type="submit" class="btn btn-primary w-100">Change password</button>
  </form>
</div>

<script>
(function () {
  const form = document.getElementById('changePasswordForm');
  const newPassword = document.getElementById('newPassword');
  const confirmPassword = document.getElementById('confirmPassword');

  function showError(input, message) {
    const err = input.parentElement.querySelector('.error');
    err.textContent = message;
    input.classList.add('is-invalid');
  }

  function showSuccess(input) {
    const err = input.parentElement.querySelector('.error');
    err.textContent = '';
    input.classList.remove('is-invalid');
  }

  function isStrongPassword(value) {
    return /^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[\W_]).{8,}$/.test(value);
  }

  function validateChangePassword() {
    let ok = true;

    if (!isStrongPassword(newPassword.value)) {
      showError(newPassword, 'Password must be 8+ chars with upper, lower, number, and symbol.');
      ok = false;
    } else {
      showSuccess(newPassword);
    }

    if (confirmPassword.value !== newPassword.value) {
      showError(confirmPassword, 'Passwords do not match.');
      ok = false;
    } else {
      showSuccess(confirmPassword);
    }

    return ok;
  }

  form.addEventListener('submit', (e) => {
    e.preventDefault();
    if (!validateChangePassword()) return;
    alert('Password successfully changed!');
    form.reset();
  });
})();
</script>

</body>
</html>